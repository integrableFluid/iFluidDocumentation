<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  
  <link rel="shortcut icon" href="../img/favicon.ico">
  <title>fluidcell - iFluid Documentation</title>
  <link href='https://fonts.googleapis.com/css?family=Lato:400,700|Roboto+Slab:400,700|Inconsolata:400,700' rel='stylesheet' type='text/css'>

  <link rel="stylesheet" href="../css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../css/theme_extra.css" type="text/css" />
  <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/github.min.css">
  
  <script>
    // Current page data
    var mkdocs_page_name = "fluidcell";
    var mkdocs_page_input_path = "iFluidTensor.md";
    var mkdocs_page_url = null;
  </script>
  
  <script src="../js/jquery-2.1.1.min.js" defer></script>
  <script src="../js/modernizr-2.8.3.min.js" defer></script>
  <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
  <script>hljs.initHighlightingOnLoad();</script> 
  
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
      <div class="wy-side-nav-search">
        <a href=".." class="icon icon-home"> iFluid Documentation</a>
        <div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
	<ul class="current">
	  
          
            <li class="toctree-l1">
		
    <a class="" href="..">Home</a>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">Documentation of main classes</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../iFluidCore/">iFluidCore</a>
                </li>
                <li class="">
                    
    <a class="" href="../iFluidSolver/">iFluidSolver</a>
                </li>
                <li class=" current">
                    
    <a class="current" href="./">fluidcell</a>
    <ul class="subnav">
            
    <li class="toctree-l3"><a href="#fluidcell">fluidcell</a></li>
    
        <ul>
        
            <li><a class="toctree-l4" href="#constructor">Constructor</a></li>
        
            <li><a class="toctree-l4" href="#accessor-methods">Accessor methods</a></li>
        
            <li><a class="toctree-l4" href="#index-manipulation-methods">Index manipulation methods</a></li>
        
            <li><a class="toctree-l4" href="#mathematical-operators">Mathematical operators</a></li>
        
        </ul>
    

    </ul>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">Additional features</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../correlations/">Correlation functions</a>
                </li>
                <li class="">
                    
    <a class="" href="../Solvers/">Implemented solvers</a>
                </li>
                <li class="">
                    
    <a class="" href="../Models/">Implemented models</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">Examples</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../LLexample/">Running an iFluid calculation</a>
                </li>
                <li class="">
                    
    <a class="" href="../model/">Implementing a new model</a>
                </li>
                <li class="">
                    
    <a class="" href="../solver/">Implementing a new algorithm</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../changelog/">Changelog</a>
	    </li>
          
        </ul>
      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="..">iFluid Documentation</a>
      </nav>

      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="..">Docs</a> &raquo;</li>
    
      
        
          <li>Documentation of main classes &raquo;</li>
        
      
    
    <li>fluidcell</li>
    <li class="wy-breadcrumbs-aside">
      
    </li>
  </ul>
  <hr/>
</div>
          <div role="main">
            <div class="section">
              
                <h1 id="fluidcell">fluidcell</h1>
<p>Quantities like the root densities of TBAs are functions of position and rapidity. Additionally, some TBAs contain multiple root densitites, each describing a different type of quasiparticle. Thus, the numerical representation of the root density can be achieved with a rank-3 tensor.  </p>
<p>Meanwhile, quantites like the two-body scattering phase encodes the interaction between two quasiparticles of (potentially) different type and rapidity. Thus, an extra type and rapidity arguement are needed resulting in a rank-5 tensor representation.  </p>
<p>Consider one of the most central operations of GHD calculations, namely the dressing of some quantity, <em>h</em>. This implies solving the set of linear equations:</p>
<p><img src="https://latex.codecogs.com/svg.latex?h_{i}^{k}&space;=&space;\sum_{j}&space;\sum_{l}&space;\left(&space;\delta_{ij}&space;\delta^{kl}&space;&plus;&space;w_{j}^{l}&space;T_{ij}^{kl}&space;\vartheta_{j}^{l}&space;\right)&space;(h&space;^&space;{&space;\mathrm&space;{&space;dr&space;}&space;})_{j}^{l}&space;=&space;\sum_{j}&space;\sum_{l}&space;U_{ij}^{kl}&space;(h&space;^&space;{&space;\mathrm&space;{&space;dr&space;}&space;})_{j}^{l}" title="h_{i}^{k} = \sum_{j} \sum_{l} \left( \delta_{ij} \delta^{kl} + w_{j}^{l} T_{ij}^{kl} \vartheta_{j}^{l} \right) (h ^ { \mathrm { dr } })_{j}^{l} = \sum_{j} \sum_{l} U_{ij}^{kl} (h ^ { \mathrm { dr } })_{j}^{l}" /></p>
<p>We won't be going into specifics regarding the quantities of the equation, however, the subscripts mark the rapidity indices, while the superscripts mark the quasiparticle type indices. The calculation requires contracting over two indices - similar to a matrix multiplication, which is just the contraction over a single index,</p>
<p>The <code>fluidcell</code> class wraps around a standard Matlab 5-dimensional matrix and generalizes many of the standard 2-dimensional methods (such as matrix multiplication) to 4D. Thus, the multiplication above can be computed in iFluid via <code>h = U*h_dr</code> or solving the equation via <code>h_dr = U\h</code>.  </p>
<p>To achieve this, the <code>fluidcell</code> class enforces a strict convention for indices, namely  </p>
<ol>
<li>Main rapidity index.  </li>
<li>Position index.  </li>
<li>Main type index.  </li>
<li>Secondary rapidity index.  </li>
<li>Secondary type index.  </li>
</ol>
<p>The purpose of the <code>fluidcell</code> is to perform multi-index contractions using the standard Matlab notation, which is achieved by overloading the mathematical operators <code>+  -  ./  *  .*  \  .^</code>.</p>
<p>The indices of the fluidcell can be accessed using the standard Matlab referencing for arrays. Similarly, the index labels (name of indices) can be used for referencing as well.</p>
<pre><code class="MATLAB">A = B(:,:,3)        % returns the 3rd type index of B
B(:,:,3) = A        % sets the 3rd type index of B equal to A
A = B('type',3)     % returns the 3rd type index of B
B('type',3) = A     % sets the 3rd type index of B equal to A
</code></pre>

<h2 id="constructor">Constructor</h2>
<p>An <code>fluidcell</code> object can be initialized using a MAtlab ND-array, which the <code>fluidcell</code> will then wrap around.</p>
<h3 id="obj-fluidcella"><code>obj = fluidcell(A)</code></h3>
<p>Construct an <code>fluidcell</code> object using the ND-array input <code>A</code> as datastructure.<br />
<strong>Inputs:</strong></p>
<ul>
<li><code>A</code>: Standard Matlab ND-array up to 5 dimensions.  </li>
</ul>
<p><strong>Returns:</strong></p>
<ul>
<li><code>obj</code>: <code>fluidcell</code> object.</li>
</ul>
<hr />
<h3 id="obj-fluidcellzerosd1-d2-dn"><code>obj = fluidcell.zeros(d1, d2, ... , dN )</code></h3>
<p>or</p>
<h3 id="obj-fluidcellzeros-d1-d2-dn"><code>obj = fluidcell.zeros( [d1, d2, ... , dN] )</code></h3>
<p>Construct an <code>fluidcell</code> object of zeros with indices of specified sizes (up to N = 5 indices).<br />
<strong>Inputs:</strong></p>
<ul>
<li><code>d1, d2, ... , dN</code>: Integers indicating size of the <em>n</em>'th index.</li>
</ul>
<p><strong>Returns:</strong></p>
<ul>
<li><code>obj</code>: <code>fluidcell</code> object.</li>
</ul>
<hr />
<h3 id="obj-fluidcellonesd1-d2-dn"><code>obj = fluidcell.ones(d1, d2, ... , dN )</code></h3>
<p>or</p>
<h3 id="obj-fluidcellones-d1-d2-dn"><code>obj = fluidcell.ones( [d1, d2, ... , dN] )</code></h3>
<p>Construct an <code>fluidcell</code> object of ones with indices of specified sizes (up to N = 5 indices).<br />
<strong>Inputs:</strong></p>
<ul>
<li><code>d1, d2, ... , dN</code>: Integers indicating size of the <em>n</em>'th index.</li>
</ul>
<p><strong>Returns:</strong></p>
<ul>
<li><code>obj</code>: <code>fluidcell</code> object.</li>
</ul>
<hr />
<h3 id="obj-fluidcelleye-d_rapid-d_type"><code>obj = fluidcell.eye( d_rapid, d_type )</code></h3>
<p>Construct a "square" <code>fluidcell</code> object with ones at entries with matching rapidity and type indices.<br />
<strong>Inputs:</strong></p>
<ul>
<li><code>d_rapid</code>: Integer indicating size of the main and secondary rapidity index.</li>
<li><code>d_type</code>: Integer indicating size of the main and secondary type index.</li>
</ul>
<p><strong>Returns:</strong></p>
<ul>
<li><code>obj</code>: <code>fluidcell</code> object.</li>
</ul>
<h2 id="accessor-methods">Accessor methods</h2>
<h3 id="s-sizeobj-idx"><code>S = size(obj, idx)</code></h3>
<p>Returns size of entire tensor or one of its indices.<br />
<strong>Inputs:</strong></p>
<ul>
<li><code>idx</code>: (optional) Index in question.</li>
</ul>
<p><strong>Returns:</strong></p>
<ul>
<li><code>S</code>: Sizes of all or specified index.</li>
</ul>
<hr />
<h3 id="out-doubleobj"><code>out = double(obj)</code></h3>
<p>Returns tensor as standard Matlab matrix of doubles.  </p>
<p><strong>Returns:</strong></p>
<ul>
<li><code>out</code>: Underlying matrix.</li>
</ul>
<h2 id="index-manipulation-methods">Index manipulation methods</h2>
<h3 id="out-flattenobj"><code>out = flatten(obj)</code></h3>
<p>Returns a 3-dimensional matrix. The first index is the main rapidity index merged with the main type index. The second index is the secondary rapidity index merged with the secondary type index. The third index is the spatial index.  </p>
<p><strong>Returns:</strong></p>
<ul>
<li><code>out</code>: Flattened tensor.</li>
</ul>
<hr />
<h3 id="out-unflattenobj"><code>out = unflatten(obj)</code></h3>
<p>Undoes the <code>flatten()</code> transformation.</p>
<p><strong>Returns:</strong></p>
<ul>
<li><code>out</code>: Un-flattened tensor.</li>
</ul>
<hr />
<h3 id="out-transposeobj-out-tobj"><code>out = transpose(obj)</code> / <code>out = t(obj)</code></h3>
<p>Returns tensor with both the two rapidity and the two type indices permuted.  </p>
<p><strong>Returns:</strong></p>
<ul>
<li><code>out</code>: Transposed tensor.</li>
</ul>
<h2 id="mathematical-operators">Mathematical operators</h2>
<p>The <code>fluidcell</code> class overloads the elementwise mathematically operations <code>+  -  ./  .*  .^</code> along with  </p>
<ul>
<li><code>abs()</code>  </li>
<li><code>log()</code>  </li>
<li><code>exp()</code>  </li>
</ul>
<p>Below are the overloaded methods, which have a different function than their Matlab counterpart.</p>
<hr />
<h3 id="c-mtimesa-b-c-ab"><code>C = mtimes(A, B)</code> / <code>C = A*B</code></h3>
<p>Performs the two-index contraction<br />
<img src="https://latex.codecogs.com/svg.latex?C_{ik}^{ln}&space;=&space;\sum_{j}&space;\sum_{m}&space;A_{ij}^{lm}&space;B_{jk}^{mn}" title="C_{ik}^{ln} = \sum_{j} \sum_{m} A_{ij}^{lm} B_{jk}^{mn}" /></p>
<p><strong>Inputs:</strong></p>
<ul>
<li><code>A</code>: Matrix or tensor with dimensions <em>( Ra, Xa, Ta, N, L )</em>, with position index length, <em>Xa</em>, equal to 1 or <em>M</em>.</li>
<li><code>B</code>: Matrix or tensor with dimensions <em>( N, Xb, L, Rb, Tb )</em>, with position index length, <em>Xb</em>, equal to 1 or <em>M</em>.</li>
</ul>
<p><strong>Returns:</strong></p>
<ul>
<li><code>C</code>: Matrix or tensor with dimensions <em>( Ra, max(Xa, Xb), Ta, Rb, Tb )</em>.</li>
</ul>
<hr />
<h3 id="x-mldividea-b-x-ab"><code>x = mldivide(A, B)</code> / <code>x = A\B</code></h3>
<p>Solves the system of linear equations<br />
<img src="https://latex.codecogs.com/svg.latex?\sum_{j}&space;\sum_{m}&space;A_{ij}^{lm}&space;X_{jk}^{mn}&space;=&space;B_{ik}^{ln}" title="\sum_{j} \sum_{m} A_{ij}^{lm} X_{jk}^{mn} = B_{ik}^{ln}" /></p>
<p><strong>Inputs:</strong></p>
<ul>
<li><code>A</code>: Matrix or tensor with dimensions <em>( N, Xa, L, Ra, Ta )</em>, with position index length, <em>Xa</em>, equal to 1 or <em>M</em>.</li>
<li><code>B</code>: Matrix or tensor with dimensions <em>( N, Xb, L, Rb, Tb )</em>, with position index length, <em>Xb</em>, equal to 1 or <em>M</em>.</li>
</ul>
<p><strong>Returns:</strong></p>
<ul>
<li><code>x</code>: Matrix or tensor with dimensions <em>( Ra, max(Xa, Xb), Ta, Rb, Tb )</em>.</li>
</ul>
<hr />
<h3 id="b-inva"><code>B = inv(A)</code></h3>
<p>Returns the solution to the equations<br />
<img src="https://latex.codecogs.com/svg.latex?\left(&space;A&space;\:&space;B&space;\right&space;)_{ij}^{lm}&space;=&space;\delta_{ij}&space;\delta^{lm}" title="\left( A \: B \right )_{ij}^{lm} = \delta_{ij} \delta^{lm}" />  </p>
<p><strong>Inputs:</strong></p>
<ul>
<li><code>A</code>: Tensor with both rapidity indices and both type indices of equal length.</li>
</ul>
<p><strong>Returns:</strong></p>
<ul>
<li><code>B</code>: "Inverse" of <code>A</code>.</li>
</ul>
<hr />
<h3 id="out-sumobj-idx-t_str"><code>out = sum(obj, idx, t_str)</code></h3>
<p>Returns the tensor summed over the given index.<br />
<strong>Inputs:</strong></p>
<ul>
<li><code>idx</code>: Integer, or vector of integers, indicating the index in quation.</li>
<li><code>t_str</code>: (optional) String indicating output type:  <ul>
<li><code>'d'</code>/<code>'double'</code>: Returns standard Matlab matrix of doubles.</li>
<li><code>'t'</code>/<code>'tensor'</code>: Returns <code>fluidcell</code>.</li>
</ul>
</li>
</ul>
<p><strong>Returns:</strong></p>
<ul>
<li><code>out</code>: Sum over <code>index</code>.</li>
</ul>
              
            </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../correlations/" class="btn btn-neutral float-right" title="Correlation functions">Next <span class="icon icon-circle-arrow-right"></span></a>
      
      
        <a href="../iFluidSolver/" class="btn btn-neutral" title="iFluidSolver"><span class="icon icon-circle-arrow-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
    
  </div>

  Built with <a href="http://www.mkdocs.org">MkDocs</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
      
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" style="cursor: pointer">
    <span class="rst-current-version" data-toggle="rst-current-version">
      
      
        <span><a href="../iFluidSolver/" style="color: #fcfcfc;">&laquo; Previous</a></span>
      
      
        <span style="margin-left: 15px"><a href="../correlations/" style="color: #fcfcfc">Next &raquo;</a></span>
      
    </span>
</div>
    <script>var base_url = '..';</script>
    <script src="../js/theme.js" defer></script>
      <script src="../search/main.js" defer></script>

</body>
</html>
