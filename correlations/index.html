<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  
  <link rel="shortcut icon" href="../img/favicon.ico">
  <title>Correlation functions - iFluid Documentation</title>
  <link href='https://fonts.googleapis.com/css?family=Lato:400,700|Roboto+Slab:400,700|Inconsolata:400,700' rel='stylesheet' type='text/css'>

  <link rel="stylesheet" href="../css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../css/theme_extra.css" type="text/css" />
  <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/github.min.css">
  
  <script>
    // Current page data
    var mkdocs_page_name = "Correlation functions";
    var mkdocs_page_input_path = "correlations.md";
    var mkdocs_page_url = null;
  </script>
  
  <script src="../js/jquery-2.1.1.min.js" defer></script>
  <script src="../js/modernizr-2.8.3.min.js" defer></script>
  <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
  <script>hljs.initHighlightingOnLoad();</script> 
  
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
      <div class="wy-side-nav-search">
        <a href=".." class="icon icon-home"> iFluid Documentation</a>
        <div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
	<ul class="current">
	  
          
            <li class="toctree-l1">
		
    <a class="" href="..">Home</a>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">Documentation of main classes</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../iFluidCore/">iFluidCore</a>
                </li>
                <li class="">
                    
    <a class="" href="../iFluidSolver/">iFluidSolver</a>
                </li>
                <li class="">
                    
    <a class="" href="../iFluidTensor/">iFluidTensor</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">Additional features</span>
    <ul class="subnav">
                <li class=" current">
                    
    <a class="current" href="./">Correlation functions</a>
    <ul class="subnav">
            
    <li class="toctree-l3"><a href="#euler-scale-dynamical-correlation-functions">Euler-scale dynamical correlation functions</a></li>
    
        <ul>
        
            <li><a class="toctree-l4" href="#methods-of-ifluidcorrelator-class">Methods of iFluidCorrelator class</a></li>
        
            <li><a class="toctree-l4" href="#examples">Examples</a></li>
        
        </ul>
    

    </ul>
                </li>
                <li class="">
                    
    <a class="" href="../Solvers/">Implemented solvers</a>
                </li>
                <li class="">
                    
    <a class="" href="../Models/">Implemented models</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">Examples</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../LLexample/">Running an iFluid calculation</a>
                </li>
                <li class="">
                    
    <a class="" href="../model/">Implementing a new model</a>
                </li>
                <li class="">
                    
    <a class="" href="../solver/">Implementing a new algorithm</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../changelog/">Changelog</a>
	    </li>
          
        </ul>
      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="..">iFluid Documentation</a>
      </nav>

      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="..">Docs</a> &raquo;</li>
    
      
        
          <li>Additional features &raquo;</li>
        
      
    
    <li>Correlation functions</li>
    <li class="wy-breadcrumbs-aside">
      
    </li>
  </ul>
  <hr/>
</div>
          <div role="main">
            <div class="section">
              
                <h1 id="euler-scale-dynamical-correlation-functions">Euler-scale dynamical correlation functions</h1>
<p>By combining GHD with the fluctuation-dissipation theorem, one can calculate exact Euler-scale dynamical two-point correlation function. In GHD, each fluid cell (point in space-time) is described by its own generalized Gibbs ensemble (GGE). Thus, all equal-time, space-separated connected correlation functions vanish. However, over time the propagation of quasi-particles causes quantities in separated fluid cells to become correlated in a non-trivial manner. Hence, dynamical correlations at the Euler scale can be viewed as initial delta-functions correlations, which over time ballistically spread and propagate throughout the system.  </p>
<h2 id="methods-of-ifluidcorrelator-class">Methods of <code>iFluidCorrelator</code> class</h2>
<p>The class <code>iFluidCorrelator</code> contains all the methods necessary for computing the correlation functions.</p>
<h3 id="constructor">Constructor</h3>
<h4 id="obj-ifluidcorrelatorcoreobj-options"><code>obj = iFluidCorrelator(coreObj, Options)</code></h4>
<p>Construct an iFluidCorrelator for calculating Euler-scale correlations.<br />
<strong>Inputs:</strong></p>
<ul>
<li><code>coreObj</code>: <code>iFluidCore</code> object specifying the model and problem at hand.  </li>
<li><code>Options</code>: Struct of settings.   </li>
</ul>
<p><strong>Returns:</strong></p>
<ul>
<li><code>obj</code>: <code>iFluidCorrelator</code> object.</li>
</ul>
<h3 id="methods-for-calculating-correlations">Methods for calculating correlations</h3>
<h4 id="direct-indirect-calc2pcorrelationsobj-theta_t-u_t-t_array-y_indices-vo1_t-vo2_0"><code>[direct, indirect] = calc2PCorrelations(obj, theta_t, u_t, t_array, y_indices, VO1_t, VO2_0)</code></h4>
<p>Calculates the two-point correlation function <img src="https://latex.codecogs.com/gif.latex?\left\langle\mathcal{O}_{1}(x,&space;t)&space;\mathcal{O}_{2}(y,&space;0)\right\rangle^{\mathrm{Eul}}" title="\left\langle\mathcal{O}_{1}(x, t) \mathcal{O}_{2}(y, 0)\right\rangle^{\mathrm{Eul}}" />, where <em>x</em> are all entries in <code>x_grid</code> specified in <code>iFluidCore</code>. The correlations split into a direct and an indirect part, where the full correlations is the sum of the two.<br />
<strong>Inputs:</strong></p>
<ul>
<li><code>theta_t</code>: Cell array of filling functions. First entry must be for time <em>t=0</em>.  </li>
<li><code>u_t</code>: Cell array of characteristic functions. First entry must be for time <em>t=0</em>.  </li>
<li><code>t_array</code>: Array of times corresponding to entries in <code>theta_t</code> and <code>u_t</code>.  </li>
<li><code>y_indices</code>: Array of indices, such that <code>x_grid(y_indices)</code> produces the desired values of <em>y</em>.</li>
<li><code>VO1_t</code>: Cell array containing form factors of operator <em>O1</em> at time <code>t_array(2:end)</code>.</li>
<li><code>VO2_0</code>: Form factor of operator <em>O2</em> at time <em>t=0</em>.</li>
</ul>
<p><strong>Returns:</strong></p>
<ul>
<li><code>direct</code>: Matrix containing the direct correlations.</li>
<li><code>indirect</code>: Matrix containing the indirect correlations.</li>
</ul>
<h2 id="examples">Examples</h2>
<p>In this example we calculate the dynamic density-current correlations of a bump release in the Lieb-Liniger model.  </p>
<p>The full example code can be found in the /Examples folder in the <a href="https://github.com/integrableFluid/iFluidMatlab">iFluid github repository</a>.</p>
<h3 id="setting-up-the-problem-and-solving-the-dynamics">Setting up the problem and solving the dynamics</h3>
<p>First we set up the grids, couplings, etc. The correlations implemented in iFluid version v1.1.0 only cover evolution with homogeneous couplings, although the initial state can be inhomogeneous.</p>
<pre><code class="MATLAB">N           = 2^7;                              % number of rapidity gridpoints
M           = 2^8+1;                            % number of spatial gridpoints
dt          = 0.025;                            % length of timestep

rmax        = 7;                                % max rapidity
xmax        = 5;                                % max posistion
tmax        = 1;                                % max time

rap_array   = linspace(-rmax, rmax, N);         % rapidity grid
rap_w       = rap_array(2) - rap_array(1);      % rapidity quadrature weights
x_array     = linspace(-xmax, xmax, M);         % position grid
t_array     = linspace(0, tmax, tmax/dt+1);     % array of timesteps

% couplings are chemical potential and interaction strength
couplings  = { @(t,x) 0 , @(t,x) 1  ;           % couplings
               []       , []        ;           % d/dt couplings  
               []       , []        };          % d/dx couplings

T           = 0.5;                              % temperature                                 
</code></pre>

<p>Next, we solve the dynamics of the system. In order to calculate the correlations, we need the filling function and the position characteristic. </p>
<pre><code class="MATLAB">%% Initialize state and solve dynamics

% Initialize TBA for the Lieb-Liniger model
TBA         = LiebLinigerModel(x_array, rap_array, rap_w, couplings);

% Intialize second order solver of the GHD equation
Solver2     = SecondOrderSolver(TBA, []);

% Set inital chemical potential and calculate thermal state
coup_init   = { @(t,x) 2 - 2*x.^2  , @(t,x) 1};
theta_init  = TBA.calcThermalState(T, coup_init);

% Propagate intial state according to the couplings
[theta_t, u_t] = Solver2.propagateTheta(theta_init, t_array);
</code></pre>

<h3 id="calculating-correlations">Calculating correlations</h3>
<p>In order to calculate the correlations between the density and its associated current, <img src="https://latex.codecogs.com/gif.latex?\left\langle\mathtt{q}_{0}(x,&space;t)&space;\mathtt{j}_{0}(y,&space;0)\right\rangle^{\mathrm{Eul}}" title="\left\langle\mathtt{q}_{0}(x, t) \mathtt{j}_{0}(y, 0)\right\rangle^{\mathrm{Eul}}" />, we need the one-particle form factor of the density  and the current operator. Both are available via the <code>calcCharges()</code> method in the <code>iFluidCore</code> class simply by passing a flag to the method. The method returns the form factors as a cell array for each time in <code>t_array</code>. Thus, we need the first cell of the current form factors and all the remaining cells of the density form factors.  </p>
<pre><code class="MATLAB">% Initialize object for calculating correlations
iCorr       = iFluidCorrelator(TBA, []);

% Calculate form factors of density and associated current
calcFormFac = true;
[q,j,Vq,Vj] = TBA.calcCharges( 0, theta_t, t_array, calcFormFac );

% Calculate correlations at y = x_array((1+M)/2) and all times in t_array
[dir, indir]= iCorr.calc2PCorrelations( theta_t, u_t, t_array, (1+M)/2, Vq(2:end), Vj{1} );
</code></pre>

<h3 id="plot-results">Plot results</h3>
<p>Finally, we can plot the results of the calculation (direct above, indirect below).  </p>
<p><img alt="Correlations" src="../img/Correlations.png" /></p>
<p>The direct and indirect correlations are plotted separately, as they are of very different scales. The direct correlations are the main contribution, and denote the correlations carried by quasi-particles with the inverse trajectories given by the characteristics. Meanwhile, the indirect correlations are due to disturbances of the trajectories due inhomogeneities in the initial state.</p>
              
            </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../Solvers/" class="btn btn-neutral float-right" title="Implemented solvers">Next <span class="icon icon-circle-arrow-right"></span></a>
      
      
        <a href="../iFluidTensor/" class="btn btn-neutral" title="iFluidTensor"><span class="icon icon-circle-arrow-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
    
  </div>

  Built with <a href="http://www.mkdocs.org">MkDocs</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
      
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" style="cursor: pointer">
    <span class="rst-current-version" data-toggle="rst-current-version">
      
      
        <span><a href="../iFluidTensor/" style="color: #fcfcfc;">&laquo; Previous</a></span>
      
      
        <span style="margin-left: 15px"><a href="../Solvers/" style="color: #fcfcfc">Next &raquo;</a></span>
      
    </span>
</div>
    <script>var base_url = '..';</script>
    <script src="../js/theme.js" defer></script>
      <script src="../search/main.js" defer></script>

</body>
</html>
